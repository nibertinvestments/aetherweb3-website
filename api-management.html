<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API Management - AetherWeb3</title>
    <script src="https://js.stripe.com/v3/"></script>
    <script src="https://accounts.google.com/gsi/client" async defer></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 3rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #00f5ff, #ff00e5);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .auth-section {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .dashboard {
            display: none;
        }

        .dashboard.active {
            display: block;
        }

        .api-keys {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .pricing-plans {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .plan {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .plan:hover {
            transform: translateY(-5px);
        }

        .plan.popular {
            border: 2px solid #00f5ff;
            position: relative;
            overflow: hidden;
        }

        .plan.popular::before {
            content: "Most Popular";
            position: absolute;
            top: 10px;
            right: -35px;
            background: #00f5ff;
            color: #000;
            padding: 5px 40px;
            transform: rotate(45deg);
            font-size: 0.8rem;
            font-weight: bold;
        }

        .plan h3 {
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .plan .price {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 15px;
            color: #00f5ff;
        }

        .plan .features {
            list-style: none;
            margin-bottom: 20px;
        }

        .plan .features li {
            padding: 5px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .chain-selection {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .chain-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .chain-option {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 15px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .chain-option:hover {
            border-color: #00f5ff;
        }

        .chain-option.selected {
            border-color: #00f5ff;
            background: rgba(0, 245, 255, 0.2);
        }

        .chain-option input[type="checkbox"] {
            margin-right: 10px;
        }

        .usage-stats {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #00f5ff;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        .btn {
            background: linear-gradient(45deg, #00f5ff, #ff00e5);
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            margin: 5px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0, 245, 255, 0.4);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .api-key-display {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            word-break: break-all;
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin: 10px 0;
        }

        .hidden {
            display: none !important;
        }

        .alert {
            padding: 15px;
            border-radius: 10px;
            margin: 10px 0;
        }

        .alert-success {
            background: rgba(0, 255, 0, 0.2);
            border: 1px solid rgba(0, 255, 0, 0.5);
        }

        .alert-error {
            background: rgba(255, 0, 0, 0.2);
            border: 1px solid rgba(255, 0, 0, 0.5);
        }

        .alert-info {
            background: rgba(0, 245, 255, 0.2);
            border: 1px solid rgba(0, 245, 255, 0.5);
        }

        .bundle-discount {
            background: linear-gradient(45deg, #ff6b6b, #ffa500);
            color: white;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            margin: 15px 0;
            font-weight: bold;
        }

        .copy-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            padding: 5px 10px;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 0.8rem;
            margin-left: 10px;
        }

        .copy-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .pricing-plans {
                grid-template-columns: 1fr;
            }
            
            .chain-grid {
                grid-template-columns: 1fr;
            }
            
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .subscription-status {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .status-active {
            border-left: 4px solid #00ff00;
        }

        .status-expired {
            border-left: 4px solid #ff0000;
        }

        .status-trial {
            border-left: 4px solid #ffa500;
        }

        .navigation {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            text-align: center;
        }

        .nav-link {
            color: white;
            text-decoration: none;
            margin: 0 20px;
            padding: 10px 20px;
            border-radius: 20px;
            transition: all 0.3s ease;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .nav-link.active {
            background: linear-gradient(45deg, #00f5ff, #ff00e5);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Navigation -->
        <div class="navigation">
            <a href="index.html" class="nav-link">Home</a>
            <a href="api-management.html" class="nav-link active">API Management</a>
            <a href="documentation.html" class="nav-link">Documentation</a>
        </div>

        <div class="header">
            <h1>API Management Dashboard</h1>
            <p>Manage your blockchain API access and subscriptions</p>
        </div>

        <!-- Authentication Section -->
        <div class="auth-section" id="authSection">
            <div style="text-align: center;">
                <h2>Sign In to Continue</h2>
                <p>Connect with Google to access your blockchain API dashboard</p>
                <br>
                <div id="g_id_onload"
                     data-client_id="YOUR_GOOGLE_CLIENT_ID"
                     data-callback="handleCredentialResponse"
                     data-auto_prompt="false">
                </div>
                <div class="g_id_signin"
                     data-type="standard"
                     data-size="large"
                     data-theme="filled_blue"
                     data-text="sign_in_with"
                     data-shape="rectangular"
                     data-logo_alignment="left">
                </div>
            </div>
        </div>

        <!-- Dashboard Content (Hidden until authenticated) -->
        <div class="dashboard" id="dashboard">
            
            <!-- Subscription Status -->
            <div class="subscription-status status-trial" id="subscriptionStatus">
                <h3>Subscription Status</h3>
                <p id="statusText">Free Trial - 7 days remaining</p>
                <p id="planDetails">100,000 requests per month included</p>
            </div>

            <!-- Usage Statistics -->
            <div class="usage-stats">
                <h3>Usage Statistics</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="requestsUsed">0</div>
                        <div class="stat-label">Requests Used</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="requestsRemaining">100,000</div>
                        <div class="stat-label">Requests Remaining</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="successRate">99.9%</div>
                        <div class="stat-label">Success Rate</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="avgLatency">45ms</div>
                        <div class="stat-label">Avg Latency</div>
                    </div>
                </div>
            </div>

            <!-- API Keys Section -->
            <div class="api-keys">
                <h3>Your API Keys</h3>
                <div id="apiKeysContainer">
                    <div class="alert alert-info">
                        <strong>No API keys found.</strong> Select chains and a plan below to generate your API keys.
                    </div>
                </div>
                <button class="btn" onclick="generateNewKey()">Generate New API Key</button>
                <button class="btn btn-secondary" onclick="revokeAllKeys()">Revoke All Keys</button>
            </div>

            <!-- Chain Selection -->
            <div class="chain-selection">
                <h3>Select Blockchain Networks</h3>
                <p>Choose which blockchain networks you want to access:</p>
                
                <div class="chain-grid">
                    <div class="chain-option" onclick="toggleChain('ethereum')">
                        <input type="checkbox" id="ethereum" value="ethereum">
                        <div>
                            <strong>Ethereum</strong><br>
                            <small>$29/month</small>
                        </div>
                    </div>
                    <div class="chain-option" onclick="toggleChain('base')">
                        <input type="checkbox" id="base" value="base">
                        <div>
                            <strong>Base</strong><br>
                            <small>$19/month</small>
                        </div>
                    </div>
                    <div class="chain-option" onclick="toggleChain('arbitrum')">
                        <input type="checkbox" id="arbitrum" value="arbitrum">
                        <div>
                            <strong>Arbitrum</strong><br>
                            <small>$24/month</small>
                        </div>
                    </div>
                    <div class="chain-option" onclick="toggleAllChains()">
                        <input type="checkbox" id="allChains" value="all">
                        <div>
                            <strong>All Chains Bundle</strong><br>
                            <small>$59/month</small>
                            <div class="bundle-discount">Save $13!</div>
                        </div>
                    </div>
                </div>

                <div id="selectedChainsDisplay" class="hidden">
                    <h4>Selected Networks:</h4>
                    <p id="selectedChainsList"></p>
                    <p><strong>Total Cost: $<span id="totalCost">0</span>/month</strong></p>
                </div>
            </div>

            <!-- Pricing Plans -->
            <div class="pricing-plans">
                <div class="plan">
                    <h3>Basic Plan</h3>
                    <div class="price">$19<span style="font-size: 1rem;">/month</span></div>
                    <ul class="features">
                        <li>100,000 requests/month</li>
                        <li>Standard rate limiting</li>
                        <li>Email support</li>
                        <li>99.9% uptime SLA</li>
                    </ul>
                    <button class="btn" onclick="selectPlan('basic')">Choose Basic</button>
                </div>

                <div class="plan popular">
                    <h3>Pro Plan</h3>
                    <div class="price">$49<span style="font-size: 1rem;">/month</span></div>
                    <ul class="features">
                        <li>1,000,000 requests/month</li>
                        <li>Priority rate limiting</li>
                        <li>Priority support</li>
                        <li>99.9% uptime SLA</li>
                        <li>Advanced analytics</li>
                    </ul>
                    <button class="btn" onclick="selectPlan('pro')">Choose Pro</button>
                </div>

                <div class="plan">
                    <h3>Enterprise</h3>
                    <div class="price">$199<span style="font-size: 1rem;">/month</span></div>
                    <ul class="features">
                        <li>Unlimited requests</li>
                        <li>Dedicated infrastructure</li>
                        <li>24/7 phone support</li>
                        <li>99.99% uptime SLA</li>
                        <li>Custom integrations</li>
                        <li>White-label options</li>
                    </ul>
                    <button class="btn" onclick="selectPlan('enterprise')">Choose Enterprise</button>
                </div>
            </div>

            <!-- Current Selection Summary -->
            <div class="chain-selection" id="selectionSummary" style="display: none;">
                <h3>Selection Summary</h3>
                <div id="summaryContent"></div>
                <button class="btn" onclick="proceedToCheckout()">Proceed to Checkout</button>
                <button class="btn btn-secondary" onclick="clearSelection()">Clear Selection</button>
            </div>

        </div>
    </div>

    <script>
        // Configuration
        const config = {
            apiBaseUrl: 'https://your-api-management-server.com/api',
            stripePublishableKey: 'pk_live_51Rz6RyL16dRIvW3aw8RmWn30hy9G8cLQCyjmsJgKh8lkOoZBSzCaPnc8AvdiAT7uXVLVVXz6pXZ1XU9QVIdG8GtP00hX4rENeW',
            googleClientId: 'YOUR_GOOGLE_CLIENT_ID'
        };

        // Global state
        let currentUser = null;
        let selectedChains = [];
        let selectedPlan = null;
        let userApiKeys = [];

        // Stripe instance
        const stripe = Stripe(config.stripePublishableKey);

        // Chain pricing
        const chainPricing = {
            ethereum: 29,
            base: 19,
            arbitrum: 24,
            all: 59
        };

        // Plan pricing
        const planPricing = {
            basic: 19,
            pro: 49,
            enterprise: 199
        };

        // Google Sign-In callback
        function handleCredentialResponse(response) {
            console.log("Encoded JWT ID token: " + response.credential);
            
            // Decode the JWT token (you should verify this on your server)
            const payload = JSON.parse(atob(response.credential.split('.')[1]));
            
            currentUser = {
                id: payload.sub,
                email: payload.email,
                name: payload.name,
                picture: payload.picture
            };

            // Hide auth section and show dashboard
            document.getElementById('authSection').style.display = 'none';
            document.getElementById('dashboard').classList.add('active');

            // Load user data
            loadUserData();
            
            showAlert('Successfully signed in!', 'success');
        }

        // Load user data from server
        async function loadUserData() {
            try {
                // Simulate API call
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Update UI with user data
                updateDashboard();
            } catch (error) {
                console.error('Error loading user data:', error);
                showAlert('Error loading user data', 'error');
            }
        }

        // Update dashboard with user data
        function updateDashboard() {
            // Update usage stats (simulated data)
            document.getElementById('requestsUsed').textContent = '45,230';
            document.getElementById('requestsRemaining').textContent = '54,770';
            
            // Load existing API keys
            loadApiKeys();
        }

        // Load API keys
        function loadApiKeys() {
            // Simulated API keys data
            userApiKeys = [
                {
                    id: 'key_1',
                    name: 'Production Key',
                    key: 'aether_live_sk_1a2b3c4d5e6f7g8h9i0j',
                    chains: ['ethereum', 'base'],
                    created: new Date('2024-01-15'),
                    lastUsed: new Date('2024-01-20')
                }
            ];

            displayApiKeys();
        }

        // Display API keys
        function displayApiKeys() {
            const container = document.getElementById('apiKeysContainer');
            
            if (userApiKeys.length === 0) {
                container.innerHTML = `
                    <div class="alert alert-info">
                        <strong>No API keys found.</strong> Select chains and a plan below to generate your API keys.
                    </div>
                `;
                return;
            }

            container.innerHTML = userApiKeys.map(key => `
                <div class="api-key-display">
                    <div style="display: flex; justify-content: between; align-items: center; margin-bottom: 10px;">
                        <strong>${key.name}</strong>
                        <button class="copy-btn" onclick="copyToClipboard('${key.key}')">Copy</button>
                    </div>
                    <div style="font-family: monospace; font-size: 0.9rem; word-break: break-all;">
                        ${key.key}
                    </div>
                    <div style="font-size: 0.8rem; margin-top: 10px; opacity: 0.8;">
                        <div>Chains: ${key.chains.join(', ')}</div>
                        <div>Created: ${key.created.toLocaleDateString()}</div>
                        <div>Last used: ${key.lastUsed.toLocaleDateString()}</div>
                    </div>
                    <div style="margin-top: 10px;">
                        <button class="btn btn-secondary" onclick="revokeKey('${key.id}')" style="font-size: 0.8rem; padding: 5px 15px;">Revoke</button>
                    </div>
                </div>
            `).join('');
        }

        // Toggle chain selection
        function toggleChain(chainId) {
            const checkbox = document.getElementById(chainId);
            const chainOption = checkbox.parentElement;
            
            if (chainId === 'all') {
                // Handle "all chains" selection
                if (checkbox.checked) {
                    // Uncheck all individual chains
                    ['ethereum', 'base', 'arbitrum'].forEach(id => {
                        document.getElementById(id).checked = false;
                        document.getElementById(id).parentElement.classList.remove('selected');
                    });
                    selectedChains = ['all'];
                } else {
                    selectedChains = [];
                }
            } else {
                // Handle individual chain selection
                if (checkbox.checked) {
                    // Uncheck "all chains" if individual chain is selected
                    document.getElementById('allChains').checked = false;
                    document.getElementById('allChains').parentElement.classList.remove('selected');
                    
                    selectedChains = selectedChains.filter(c => c !== 'all');
                    if (!selectedChains.includes(chainId)) {
                        selectedChains.push(chainId);
                    }
                } else {
                    selectedChains = selectedChains.filter(c => c !== chainId);
                }
            }

            // Update UI
            chainOption.classList.toggle('selected', checkbox.checked);
            updateSelectedChainsDisplay();
        }

        // Toggle all chains
        function toggleAllChains() {
            const allChainsCheckbox = document.getElementById('allChains');
            toggleChain('all');
        }

        // Update selected chains display
        function updateSelectedChainsDisplay() {
            const display = document.getElementById('selectedChainsDisplay');
            const chainsList = document.getElementById('selectedChainsList');
            const totalCostElement = document.getElementById('totalCost');

            if (selectedChains.length === 0) {
                display.classList.add('hidden');
                return;
            }

            display.classList.remove('hidden');

            let totalCost = 0;
            let chainNames = [];

            if (selectedChains.includes('all')) {
                chainNames = ['Ethereum', 'Base', 'Arbitrum (Bundle)'];
                totalCost = chainPricing.all;
            } else {
                selectedChains.forEach(chain => {
                    chainNames.push(chain.charAt(0).toUpperCase() + chain.slice(1));
                    totalCost += chainPricing[chain];
                });
            }

            chainsList.textContent = chainNames.join(', ');
            totalCostElement.textContent = totalCost;
        }

        // Select a plan
        function selectPlan(plan) {
            selectedPlan = plan;
            
            // Update UI to show selection
            document.querySelectorAll('.plan').forEach(p => p.classList.remove('selected'));
            event.target.closest('.plan').classList.add('selected');
            
            updateSelectionSummary();
            showAlert(`${plan.charAt(0).toUpperCase() + plan.slice(1)} plan selected!`, 'info');
        }

        // Update selection summary
        function updateSelectionSummary() {
            if (!selectedPlan || selectedChains.length === 0) return;

            const summary = document.getElementById('selectionSummary');
            const content = document.getElementById('summaryContent');

            let chainCost = 0;
            let chainNames = [];

            if (selectedChains.includes('all')) {
                chainNames = ['All Chains Bundle'];
                chainCost = chainPricing.all;
            } else {
                selectedChains.forEach(chain => {
                    chainNames.push(chain.charAt(0).toUpperCase() + chain.slice(1));
                    chainCost += chainPricing[chain];
                });
            }

            const planCost = planPricing[selectedPlan];
            const totalCost = chainCost + planCost;

            content.innerHTML = `
                <div style="background: rgba(255, 255, 255, 0.1); padding: 20px; border-radius: 10px;">
                    <h4>Selected Plan: ${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)}</h4>
                    <p>Plan Cost: $${planCost}/month</p>
                    
                    <h4>Selected Chains: ${chainNames.join(', ')}</h4>
                    <p>Chain Cost: $${chainCost}/month</p>
                    
                    <hr style="margin: 15px 0; border: 1px solid rgba(255, 255, 255, 0.2);">
                    <h3>Total: $${totalCost}/month</h3>
                </div>
            `;

            summary.style.display = 'block';
        }

        // Proceed to checkout
        async function proceedToCheckout() {
            if (!selectedPlan || selectedChains.length === 0) {
                showAlert('Please select a plan and at least one chain', 'error');
                return;
            }

            try {
                // Create checkout session (simulate API call)
                showAlert('Redirecting to secure checkout...', 'info');
                
                // In a real implementation, you would call your backend to create a Stripe checkout session
                // const response = await fetch('/api/create-checkout-session', { ... });
                // const session = await response.json();
                // await stripe.redirectToCheckout({ sessionId: session.id });
                
                // For demo purposes, simulate successful checkout
                setTimeout(() => {
                    showAlert('Checkout completed! Your API keys are being generated.', 'success');
                    generateApiKeysForSubscription();
                }, 2000);
                
            } catch (error) {
                console.error('Checkout error:', error);
                showAlert('Checkout failed. Please try again.', 'error');
            }
        }

        // Generate API keys for subscription
        function generateApiKeysForSubscription() {
            const newKey = {
                id: 'key_' + Date.now(),
                name: `${selectedPlan.charAt(0).toUpperCase() + selectedPlan.slice(1)} Key`,
                key: `aether_live_sk_${Math.random().toString(36).substr(2, 20)}`,
                chains: selectedChains.includes('all') ? ['ethereum', 'base', 'arbitrum'] : selectedChains,
                created: new Date(),
                lastUsed: null
            };

            userApiKeys.push(newKey);
            displayApiKeys();
            
            // Clear selection
            clearSelection();
            showAlert('API key generated successfully!', 'success');
        }

        // Clear selection
        function clearSelection() {
            selectedChains = [];
            selectedPlan = null;
            
            // Uncheck all checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => {
                cb.checked = false;
                cb.parentElement.classList.remove('selected');
            });
            
            // Hide displays
            document.getElementById('selectedChainsDisplay').classList.add('hidden');
            document.getElementById('selectionSummary').style.display = 'none';
            
            // Remove plan selection
            document.querySelectorAll('.plan').forEach(p => p.classList.remove('selected'));
        }

        // Generate new API key
        function generateNewKey() {
            if (userApiKeys.length >= 5) {
                showAlert('Maximum of 5 API keys allowed. Please revoke unused keys first.', 'error');
                return;
            }

            const keyName = prompt('Enter a name for this API key:');
            if (!keyName) return;

            const newKey = {
                id: 'key_' + Date.now(),
                name: keyName,
                key: `aether_live_sk_${Math.random().toString(36).substr(2, 20)}`,
                chains: ['ethereum'], // Default to Ethereum
                created: new Date(),
                lastUsed: null
            };

            userApiKeys.push(newKey);
            displayApiKeys();
            showAlert('New API key generated!', 'success');
        }

        // Revoke specific key
        function revokeKey(keyId) {
            if (confirm('Are you sure you want to revoke this API key? This action cannot be undone.')) {
                userApiKeys = userApiKeys.filter(key => key.id !== keyId);
                displayApiKeys();
                showAlert('API key revoked successfully', 'success');
            }
        }

        // Revoke all keys
        function revokeAllKeys() {
            if (confirm('Are you sure you want to revoke ALL API keys? This action cannot be undone.')) {
                userApiKeys = [];
                displayApiKeys();
                showAlert('All API keys revoked', 'success');
            }
        }

        // Copy to clipboard
        function copyToClipboard(text) {
            navigator.clipboard.writeText(text).then(() => {
                showAlert('API key copied to clipboard!', 'success');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                showAlert('Failed to copy to clipboard', 'error');
            });
        }

        // Show alert
        function showAlert(message, type = 'info') {
            // Remove existing alerts
            document.querySelectorAll('.alert').forEach(alert => {
                if (alert.style.position === 'fixed') {
                    alert.remove();
                }
            });

            const alert = document.createElement('div');
            alert.className = `alert alert-${type}`;
            alert.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                max-width: 300px;
            `;
            alert.textContent = message;

            document.body.appendChild(alert);

            // Auto-remove after 5 seconds
            setTimeout(() => {
                alert.remove();
            }, 5000);
        }

        // Initialize Google Sign-In
        window.onload = function() {
            // Google Sign-In initialization is handled by the script tag
            console.log('API Management Dashboard loaded');
        };
    </script>
</body>
</html>